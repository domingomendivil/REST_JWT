-------------------------------------------------------------------------------
Test set: uy.gub.dgi.jwt.JWTConsumerImplTest
-------------------------------------------------------------------------------
Tests run: 5, Failures: 0, Errors: 2, Skipped: 0, Time elapsed: 6.215 sec <<< FAILURE!
testGenerateRefreshToken(uy.gub.dgi.jwt.JWTConsumerImplTest)  Time elapsed: 0.286 sec  <<< ERROR!
uy.gub.dgi.jwt.JWTConsumerException: org.jose4j.jwt.consumer.InvalidJwtException: JWT (claims->{"iss":"Issuer","aud":"refreshToken","exp":1482420447,"jti":"5jak-rjbl7Nl1s0glpufjQ","iat":1482419847,"nbf":1482419727,"sub":"pepe","email":"mail@example.com","scopes":["administrator","provider"],"groups":["group-one","other-group","group-three"]}) rejected due to invalid claims. Additional details: [Audience (aud) claim [refreshToken] doesn't contain an acceptable identifier. Expected Audience as an aud value.]
	at uy.gub.dgi.jwt.JWTConsumerImpl.validateJWT(JWTConsumerImpl.java:64)
	at uy.gub.dgi.jwt.JWTConsumerImplTest.testGenerateRefreshToken(JWTConsumerImplTest.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.mockito.internal.runners.JUnit45AndHigherRunnerImpl.run(JUnit45AndHigherRunnerImpl.java:37)
	at org.mockito.runners.MockitoJUnitRunner.run(MockitoJUnitRunner.java:62)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
Caused by: org.jose4j.jwt.consumer.InvalidJwtException: JWT (claims->{"iss":"Issuer","aud":"refreshToken","exp":1482420447,"jti":"5jak-rjbl7Nl1s0glpufjQ","iat":1482419847,"nbf":1482419727,"sub":"pepe","email":"mail@example.com","scopes":["administrator","provider"],"groups":["group-one","other-group","group-three"]}) rejected due to invalid claims. Additional details: [Audience (aud) claim [refreshToken] doesn't contain an acceptable identifier. Expected Audience as an aud value.]
	at org.jose4j.jwt.consumer.JwtConsumer.validate(JwtConsumer.java:426)
	at org.jose4j.jwt.consumer.JwtConsumer.processContext(JwtConsumer.java:277)
	at org.jose4j.jwt.consumer.JwtConsumer.process(JwtConsumer.java:395)
	at org.jose4j.jwt.consumer.JwtConsumer.processToClaims(JwtConsumer.java:155)
	at uy.gub.dgi.jwt.JWTConsumerImpl.validateJWT(JWTConsumerImpl.java:57)
	... 32 more

testGenerateAccessToken(uy.gub.dgi.jwt.JWTConsumerImplTest)  Time elapsed: 0.031 sec  <<< ERROR!
uy.gub.dgi.jwt.JWTConsumerException: org.jose4j.jwt.consumer.InvalidJwtException: JWT (claims->{"iss":"Issuer","aud":"accessToken","exp":1482420447,"jti":"IVItGVPqzGFPpYxYzUOBVA","iat":1482419847,"nbf":1482419727,"sub":"pepe","email":"mail@example.com","scopes":["administrator","provider"],"groups":["group-one","other-group","group-three"]}) rejected due to invalid claims. Additional details: [Audience (aud) claim [accessToken] doesn't contain an acceptable identifier. Expected Audience as an aud value.]
	at uy.gub.dgi.jwt.JWTConsumerImpl.validateJWT(JWTConsumerImpl.java:64)
	at uy.gub.dgi.jwt.JWTConsumerImplTest.testGenerateAccessToken(JWTConsumerImplTest.java:65)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.mockito.internal.runners.JUnit45AndHigherRunnerImpl.run(JUnit45AndHigherRunnerImpl.java:37)
	at org.mockito.runners.MockitoJUnitRunner.run(MockitoJUnitRunner.java:62)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
Caused by: org.jose4j.jwt.consumer.InvalidJwtException: JWT (claims->{"iss":"Issuer","aud":"accessToken","exp":1482420447,"jti":"IVItGVPqzGFPpYxYzUOBVA","iat":1482419847,"nbf":1482419727,"sub":"pepe","email":"mail@example.com","scopes":["administrator","provider"],"groups":["group-one","other-group","group-three"]}) rejected due to invalid claims. Additional details: [Audience (aud) claim [accessToken] doesn't contain an acceptable identifier. Expected Audience as an aud value.]
	at org.jose4j.jwt.consumer.JwtConsumer.validate(JwtConsumer.java:426)
	at org.jose4j.jwt.consumer.JwtConsumer.processContext(JwtConsumer.java:277)
	at org.jose4j.jwt.consumer.JwtConsumer.process(JwtConsumer.java:395)
	at org.jose4j.jwt.consumer.JwtConsumer.processToClaims(JwtConsumer.java:155)
	at uy.gub.dgi.jwt.JWTConsumerImpl.validateJWT(JWTConsumerImpl.java:57)
	... 32 more

